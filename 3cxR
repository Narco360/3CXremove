Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -force
Write-Host "Script execution started."

Set-variable -Name "PCname"  -Value  "$([Environment]::MachineName)"  <#read pc name#> 
Get-variable -Name "PCname"    <#show pc name#>    

if (Get-Process -Name "3CXDesktopApp" -ErrorAction SilentlyContinue) {
    write-host "The app is running, killing it !"
    Stop-Process -Name "3CXDesktopApp" -Force
}

$ListOfLocations = @(
    "C:\Program Files\3CXDesktopApp",
    "C:\Programmes\3CXDesktopApp",
    "C:\Programmes (x86)\3CXDesktopApp",
    "C:\Program Files (x86)\3CXDesktopApp",
    "C:\Program Files\3CX Desktop App",
    "C:\Programmes\3CX Desktop App",
    "C:\Programmes (x86)\3CX Desktop App",
    "C:\Program Files (x86)\3CX Desktop App"    <# #added some new locations and corrected the missing C: from the previous one #>
    )
 
foreach ($Location in $ListOfLocations){
 
    $FoundInstances = Get-Item -Path $Location -ErrorAction SilentlyContinue
 
    foreach ($FoundInstance in $FoundInstances){
        write-host "Found 3CX Desktop folders at '$FoundInstance', Deleting folders..."
        Remove-Item -Path $FoundInstance -Recurse
    }
}
pause
