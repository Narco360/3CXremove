Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -force
Write-Host "Script execution started."

Set-variable -Name "PCname"  -Value  "$([Environment]::MachineName)"  <#read pc name#> 
Get-variable -Name "PCname"    <#show pc name#>    

if (Get-Process -Name "3CXDesktopApp" -ErrorAction SilentlyContinue) {
    write-host "The app is running, killing it !"
    Stop-Process -Name "3CXDesktopApp" -Force
}

$ListOfLocations = @(
    "C:\Program Files\3CXDesktopApp",
    "C:\Programmes\3CXDesktopApp",
    "C:\Programmes (x86)\3CXDesktopApp",
    "C:\Program Files (x86)\3CXDesktopApp",
    "C:\Program Files\3CX Desktop App",
    "C:\Programmes\3CX Desktop App",
    "C:\Programmes (x86)\3CX Desktop App",
    "C:\Program Files (x86)\3CX Desktop App"    <# #added some new locations and corrected the missing C: from the previous one #>
    )
 
foreach ($Location in $ListOfLocations) {
    if (Test-Path $Location) {
        Write-Host "Found 3CX Desktop App at '$Location', deleting folder..."
        Remove-Item -Path $Location -Recurse -Force
        Write-Host "Successfully removed 3CX Desktop App at '$Location'"
    } else {
        Write-Host "3CX Desktop App not found at '$Location'"
    }
}

#pause
