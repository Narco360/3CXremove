# powershell script

<# This script uses the Win32_Product WMI class to check if the "3CXDesktopApp" application is installed. 
If found, it proceeds to uninstall the application by calling the Uninstall() method on each program instance. #>

Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope CurrentUser -Force
Write-Host "Script execution started."

$PCname = $env:COMPUTERNAME
Write-Host "PC name: $PCname"

if (Get-Process -Name "3CXDesktopApp" -ErrorAction SilentlyContinue) {
    Write-Host "The application is currently running. Stopping it..."
    Stop-Process -Name "3CXDesktopApp" -Force
}

$Programs = Get-WmiObject -Class Win32_Product | Where-Object { $_.Name -eq "3CXDesktopApp" }
if ($Programs) {
    Write-Host "Found the '3CXDesktopApp' application. Uninstalling..."
    foreach ($Program in $Programs) {
        $Program.Uninstall()
    }
    Write-Host "Uninstallation completed."
} else {
    Write-Host "The '3CXDesktopApp' application is not installed."
}
